{"remainingRequest":"/Users/qinnan/Desktop/hospital/node-app/client/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/qinnan/Desktop/hospital/node-app/client/src/views/login.vue?vue&type=style&index=0&id=7589b93f&scoped=true&lang=css&","dependencies":[{"path":"/Users/qinnan/Desktop/hospital/node-app/client/src/views/login.vue","mtime":1539743032255},{"path":"/Users/qinnan/Desktop/hospital/node-app/client/node_modules/css-loader/index.js","mtime":1539743027272},{"path":"/Users/qinnan/Desktop/hospital/node-app/client/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/qinnan/Desktop/hospital/node-app/client/node_modules/postcss-loader/lib/index.js","mtime":1539743030157},{"path":"/Users/qinnan/Desktop/hospital/node-app/client/node_modules/cache-loader/dist/cjs.js","mtime":1539743026284},{"path":"/Users/qinnan/Desktop/hospital/node-app/client/node_modules/vue-loader/lib/index.js","mtime":1539743031717}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.login {\n  position: relative;\n  width: 100%;\n  height: 100%;\n  background: url(../assets/img/login_bg.jpg) no-repeat center center;\n  background-size: 100% 100%;\n}\n.form_container {\n  width: 450px;\n  height: 200px;\n  position: absolute;\n  top: 10%;\n  left: 30%;\n  padding: 30px;\n  border-radius: 5px;\n  text-align: center;\n}\n.form_container .manage_tip .title {\n  font-family: \"Microsoft YaHei\";\n  font-weight: bold;\n  font-size: 26px;\n  color: #fff;\n}\n.loginForm {\n  margin-top: 35px;\n  background-color: #fff;\n  padding: 46px 55px 30px 30px;\n  border-radius: 5px;\n  box-shadow: 0px 5px 20px #cccc;\n}\n\n.submit_btn {\n  width: 100%;\n}\n\n.tiparea{\n    margin-top: 5px;\n    text-align: right;\n    font-size: 13px;\n    color: #333;\n}\n\n.tiparea p a {\n    color: #409eff;\n}\n",{"version":3,"sources":["login.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"login.vue","sourceRoot":"src/views","sourcesContent":["<template>\n    <div class=\"login\">\n        <section class=\"form_container\">\n            <div class=\"manage_tip\">\n                <span class=\"title\">Uhealth移動醫療診所系統</span>\n            </div>\n            <el-form :model=\"loginUser\" :rules=\"rules\" class=\"loginForm\" ref=\"loginForm\" label-width=\"60px\">\n    \n                <el-form-item label=\"郵箱\" prop=\"email\">\n                    <el-input v-model=\"loginUser.email\" placeholder=\"請輸入郵箱\"></el-input>\n                </el-form-item>\n                <el-form-item label=\"密碼\" prop=\"password\">\n                    <el-input v-model=\"loginUser.password\" placeholder=\"請輸入密碼\" type=\"password\"></el-input>\n                </el-form-item>  \n                <el-form-item>\n                    <el-button type=\"primary\" class=\"submit_btn\" @click=\"submitForm('loginForm')\">登 錄</el-button>\n                </el-form-item>\n                <div class='tiparea'> \n                    <p>還沒有賬號？現在就 <router-link to='/register'>註 冊</router-link></p>\n                </div>\n            </el-form>\n        </section>\n    </div>\n</template>\n\n<script>\nimport jwt_decode from 'jwt-decode'\nexport default {\n  name: \"login\",\n  data() {\n    return {\n      loginUser: {\n        email: \"\",\n        password: \"\",\n      },\n      rules: {\n        email: [\n          {\n            type: \"email\",\n            required: true,\n            message: \"郵箱格式不正確！\",\n            trigger: \"blur\"\n          }\n        ],\n        password: [\n          { required: true, message: \"密碼不能為空\", trigger: \"blur\" },\n          { min: 6, max: 15, message: \"長度在 6 至 15 個字符之間\", trigger: \"blur\" }\n        ]\n      }\n    };\n  },\n  methods: {\n    submitForm(formName) {\n      this.$refs[formName].validate(valid => {\n        if (valid) {\n          this.$axios.post(\"/api/users/login\", this.loginUser).then(res => {\n              //token\n              //console.log(res);\n              const {token}=res.data;\n              //存储到LS\n              localStorage.setItem('eleToken',token);\n              //解析token\n              const decoded = jwt_decode(token);\n              //console.log(decoded);\n\n               // 存储数据\n                this.$store.dispatch(\"setIsAutnenticated\", !this.isEmpty(decoded));\n                this.$store.dispatch(\"setUser\", decoded);\n\n\n              this.$router.push(\"/index\");\n              });\n        } \n      });\n    },\n    isEmpty(value){\n        return(\n            value === undefined ||\n            value === null ||\n            (typeof value === \"object\" && Object.keys(value).length === 0) ||\n            (typeof value === \"string\" && value.trim().length === 0)\n        );\n    }\n  }\n};\n</script>\n\n\n<style scoped>\n.login {\n  position: relative;\n  width: 100%;\n  height: 100%;\n  background: url(../assets/img/login_bg.jpg) no-repeat center center;\n  background-size: 100% 100%;\n}\n.form_container {\n  width: 450px;\n  height: 200px;\n  position: absolute;\n  top: 10%;\n  left: 30%;\n  padding: 30px;\n  border-radius: 5px;\n  text-align: center;\n}\n.form_container .manage_tip .title {\n  font-family: \"Microsoft YaHei\";\n  font-weight: bold;\n  font-size: 26px;\n  color: #fff;\n}\n.loginForm {\n  margin-top: 35px;\n  background-color: #fff;\n  padding: 46px 55px 30px 30px;\n  border-radius: 5px;\n  box-shadow: 0px 5px 20px #cccc;\n}\n\n.submit_btn {\n  width: 100%;\n}\n\n.tiparea{\n    margin-top: 5px;\n    text-align: right;\n    font-size: 13px;\n    color: #333;\n}\n\n.tiparea p a {\n    color: #409eff;\n}\n</style>\n\n\n\n"]}]}