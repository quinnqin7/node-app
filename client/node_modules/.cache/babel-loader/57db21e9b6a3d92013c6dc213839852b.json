{"remainingRequest":"/Users/qinnan/Desktop/hospital/node-app/client/node_modules/babel-loader/lib/index.js!/Users/qinnan/Desktop/hospital/node-app/client/src/http.js","dependencies":[{"path":"/Users/qinnan/Desktop/hospital/node-app/client/src/http.js","mtime":1539743032252},{"path":"/Users/qinnan/Desktop/hospital/node-app/client/node_modules/cache-loader/dist/cjs.js","mtime":1539743026284},{"path":"/Users/qinnan/Desktop/hospital/node-app/client/node_modules/babel-loader/lib/index.js","mtime":1539743026004}],"contextDependencies":[],"result":["import axios from 'axios';\nimport { Message, Loading } from 'element-ui';\nimport router from './router';\nvar loading;\n\nfunction startLoading() {\n  loading = Loading.service({\n    lock: true,\n    text: '拼命加載中...',\n    background: 'rgba(0,0,0,0,7)'\n  });\n}\n\nfunction endLoading() {\n  loading.close();\n} //请求拦截\n\n\naxios.interceptors.request.use(function (config) {\n  //加載動畫\n  startLoading();\n\n  if (localStorage.eleToken) {\n    //设置统一的请求header\n    config.headers.Authorization = localStorage.eleToken;\n  }\n\n  return config;\n}, function (error) {\n  return Promise.reject(error);\n}); //响应拦截\n\naxios.interceptors.response.use(function (response) {\n  //結束加載動畫\n  endLoading();\n  return response;\n}, function (error) {\n  //錯誤提醒\n  endLoading();\n  Message.error(error.response.data); //获取错误状态码\n\n  var status = error.response.status;\n\n  if (status == 401) {\n    Message.error('token失效，請重新登錄!'); //清除Tooken\n\n    localStorage.removeItem('eleToken'); //跳轉到登錄頁面\n\n    router.push('/login');\n  }\n\n  return Promise.reject(error);\n});\nexport default axios;",{"version":3,"sources":["/Users/qinnan/Desktop/hospital/node-app/client/src/http.js"],"names":["axios","Message","Loading","router","loading","startLoading","service","lock","text","background","endLoading","close","interceptors","request","use","localStorage","eleToken","config","headers","Authorization","Promise","reject","error","response","data","status","removeItem","push"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAAQC,OAAR,EAAiBC,OAAjB,QAA+B,YAA/B;AACA,OAAOC,MAAP,MAAmB,UAAnB;AAEA,IAAIC,OAAJ;;AACA,SAASC,YAAT,GAAuB;AACnBD,YAAUF,QAAQI,OAAR,CAAgB;AACtBC,UAAK,IADiB;AAEtBC,UAAK,UAFiB;AAGtBC,gBAAW;AAHW,GAAhB,CAAV;AAKH;;AAED,SAASC,UAAT,GAAqB;AACjBN,UAAQO,KAAR;AACH,C,CAED;;;AACAX,MAAMY,YAAN,CAAmBC,OAAnB,CAA2BC,GAA3B,CAA+B,kBAAS;AACpC;AACAT;;AACA,MAAGU,aAAaC,QAAhB,EAAyB;AACrB;AACAC,WAAOC,OAAP,CAAeC,aAAf,GAA+BJ,aAAaC,QAA5C;AACH;;AACD,SAAOC,MAAP;AACH,CARD,EAQE,iBAAQ;AACN,SAAOG,QAAQC,MAAR,CAAeC,KAAf,CAAP;AACH,CAVD,E,CAYA;;AACAtB,MAAMY,YAAN,CAAmBW,QAAnB,CAA4BT,GAA5B,CAAgC,oBAAW;AACvC;AACAJ;AACA,SAAOa,QAAP;AACH,CAJD,EAIE,iBAAS;AACP;AACAb;AACAT,UAAQqB,KAAR,CAAcA,MAAMC,QAAN,CAAeC,IAA7B,EAHO,CAKP;;AALO,MAMCC,MAND,GAMYH,MAAMC,QANlB,CAMCE,MAND;;AAOP,MAAGA,UAAU,GAAb,EAAiB;AACbxB,YAAQqB,KAAR,CAAc,gBAAd,EADa,CAEb;;AACAP,iBAAaW,UAAb,CAAwB,UAAxB,EAHa,CAIb;;AACAvB,WAAOwB,IAAP,CAAY,QAAZ;AACH;;AAED,SAAOP,QAAQC,MAAR,CAAeC,KAAf,CAAP;AACH,CApBD;AAuBA,eAAetB,KAAf","sourcesContent":["import axios from 'axios';\nimport {Message, Loading} from 'element-ui';\nimport router from './router';\n\nlet loading;\nfunction startLoading(){\n    loading = Loading.service({\n        lock:true,\n        text:'拼命加載中...',\n        background:'rgba(0,0,0,0,7)'\n    });\n}\n\nfunction endLoading(){\n    loading.close();\n}\n\n//请求拦截\naxios.interceptors.request.use(config =>{\n    //加載動畫\n    startLoading();\n    if(localStorage.eleToken){\n        //设置统一的请求header\n        config.headers.Authorization = localStorage.eleToken;\n    }\n    return config;\n},error =>{\n    return Promise.reject(error)\n});\n\n//响应拦截\naxios.interceptors.response.use(response =>{\n    //結束加載動畫\n    endLoading();\n    return response;\n},error => {\n    //錯誤提醒\n    endLoading();\n    Message.error(error.response.data);\n\n    //获取错误状态码\n    const { status } = error.response;\n    if(status == 401){\n        Message.error('token失效，請重新登錄!');\n        //清除Tooken\n        localStorage.removeItem('eleToken');\n        //跳轉到登錄頁面\n        router.push('/login');\n    }\n\n    return Promise.reject(error);\n});\n\n\nexport default axios;\n"]}]}